# PSU-CIDD-Rwanda

This repository contains configuration, GIS, analysis files used for modeling the prevalence of malaria (*P. falciparum*) in Rwanda. These configurations are primarily intended to study 1) the development of antimalarial resistance in the parasite, and 2) possible interventions that the National Malaria Control Programme can implement.

The origin repository for the simulation can be found at [maciekboni/PSU-CIDD-Malaria-Simulation](https://github.com/maciekboni/PSU-CIDD-Malaria-Simulation), although the studies in this repository are intended to be run against 4.0.0 and 4.0.x versions that can be found under [rjzupkoii/PSU-CIDD-Malaria-Simulation](https://github.com/rjzupkoii/PSU-CIDD-Malaria-Simulation).

### Dependencies 

The following dependencies need to be installed for all of the scripts included in this repository to run:

- numpy : https://pypi.org/project/numpy/
- scipy : https://pypi.org/project/scipy/

## Organization

GIS     - GIS files for Rwanda, as prepared for the simulation. Note that two versions of the *Pf*PR<sub>2-10</sub> files are included. One based upon the original version of the Malaria Atlas project projections (`rwa_pfpr2to10_v2017.asc`) and one based upon the updated 2020 version (`rwa_pfpr_v2020.asc`). The `rwa_pfpr2to10.asc` is the canonical file for generating the beta values.

Scripts - Scripts used for model calibration and analysis.

Studies - Configuration files used for model validation and *de novo* mutation simulations.

## Model Execution

All simulations were performed on the Pennsylvania State University’s Institute for Computational and Data Sciences’ Roar supercomputer using the configurations present in [Studies](Studies/).

# Development Notes

## Plots

Most of the data for the plots was retrieved from the database using the `Analysis/loader.py`; however, for the 561H allele frequency validation plots, the data was retrieved using the query general aggregation query in `Analysis/queries.sql` along with the stored procedure defined in the same. These plots in turn are based upon the `Studies/Verification/rwa-561h-verification.yml` configuration which was run with just the `DbReporterDistrict` reporter. Hence no genotype carrier data in the spike data file. The five panel plot used in the manuscript was generated by `Plotting/rwa_district_plot.py` as opposed to the `Plotting/rwa_national_plot.py` used for the violin plots.